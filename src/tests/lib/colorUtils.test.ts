import { buildColorsForLegend, generateColorArray, generateLegend } from '@/lib/colorUtils.ts'
import { describe, expect, it } from 'vitest'

describe('buildColorsForLegend', () => {
  it('default colors are built correctly', () => {
    const expected = [
      [0.15999999999999998, 0.8, 0.5696000000000001],
      [0.5952000000000001, 0.8, 0.15999999999999998],
      [0.8, 0.15999999999999998, 0.15999999999999998]
    ]
    expect(buildColorsForLegend(3)).toEqual(expected)
  })
})

describe('generateLegend', () => {
  it('generate legend', () => {
    const expected = [
      {
        rangeStart: 0,
        rangeEnd: 1,
        color: [0.15999999999999998, 0.547657142857143, 0.8]
      },
      {
        rangeStart: 1,
        rangeEnd: 2,
        color: [0.15999999999999998, 0.8, 0.6902857142857144]
      },
      {
        rangeStart: 2,
        rangeEnd: 3,
        color: [0.15999999999999998, 0.8, 0.3282285714285714]
      },
      {
        rangeStart: 3,
        rangeEnd: 4,
        color: [0.35382857142857144, 0.8, 0.15999999999999998]
      },
      {
        rangeStart: 4,
        rangeEnd: 5,
        color: [0.7158857142857142, 0.8, 0.15999999999999998]
      },
      {
        rangeStart: 5,
        rangeEnd: 6,
        color: [0.8, 0.5220571428571429, 0.15999999999999998]
      },
      {
        rangeStart: 6,
        rangeEnd: 7,
        color: [0.8, 0.15999999999999998, 0.15999999999999998]
      }
    ]
    expect(generateLegend(0, 7)).toEqual(expected)
  })
})

describe('generateColorArray', () => {
  it('generate color array', () => {
    const expected = new Float32Array([
      0.8, 0.15999999999999998, 0.15999999999999998, 0.8, 0.15999999999999998, 0.15999999999999998, 0.8,
      0.15999999999999998, 0.15999999999999998, 0.8, 0.15999999999999998, 0.15999999999999998, 0.8, 0.15999999999999998,
      0.15999999999999998, 0.8, 0.15999999999999998, 0.15999999999999998, 0.8, 0.15999999999999998, 0.15999999999999998,
      0.8, 0.15999999999999998, 0.15999999999999998, 0.8, 0.15999999999999998, 0.15999999999999998, 0.8,
      0.15999999999999998, 0.15999999999999998, 0.8, 0.15999999999999998, 0.15999999999999998, 0.8, 0.15999999999999998,
      0.15999999999999998,

      0.15999999999999998, 0.547657142857143, 0.8, 0.15999999999999998, 0.547657142857143, 0.8, 0.15999999999999998,
      0.547657142857143, 0.8, 0.15999999999999998, 0.547657142857143, 0.8, 0.15999999999999998, 0.547657142857143, 0.8,
      0.15999999999999998, 0.547657142857143, 0.8, 0.15999999999999998, 0.547657142857143, 0.8, 0.15999999999999998,
      0.547657142857143, 0.8, 0.15999999999999998, 0.547657142857143, 0.8, 0.15999999999999998, 0.547657142857143, 0.8,
      0.15999999999999998, 0.547657142857143, 0.8, 0.15999999999999998, 0.547657142857143, 0.8,

      0.35382857142857144, 0.8, 0.15999999999999998, 0.35382857142857144, 0.8, 0.15999999999999998, 0.35382857142857144,
      0.8, 0.15999999999999998, 0.35382857142857144, 0.8, 0.15999999999999998, 0.35382857142857144, 0.8,
      0.15999999999999998, 0.35382857142857144, 0.8, 0.15999999999999998, 0.35382857142857144, 0.8, 0.15999999999999998,
      0.35382857142857144, 0.8, 0.15999999999999998, 0.35382857142857144, 0.8, 0.15999999999999998, 0.35382857142857144,
      0.8, 0.15999999999999998, 0.35382857142857144, 0.8, 0.15999999999999998, 0.35382857142857144, 0.8,
      0.15999999999999998
    ])
    expect(generateColorArray([7, 0, 3], 0, 7)).toEqual(expected)
  })
})
